<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UBC Solar Simulation: Main</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UBC Solar Simulation
   </div>
   <div id="projectbrief">UBC Solar&#39;s simulation environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Main</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md3"></a> </p>
<h1><a class="anchor" id="autotoc_md4"></a>
Table of Contents</h1>
<ol type="1">
<li>Overview</li>
<li>Classes<ol type="a">
<li><a class="el" href="dir_7487f41de01cca700e4de80b884d7106.html">Simulation</a><ol type="i">
<li>init()</li>
<li>run_model()</li>
<li>get_results()</li>
<li>was_successful()</li>
<li>get_distance_before_exhaustion()</li>
<li>get_driving_time_divisions()</li>
</ol>
</li>
<li>Model<ol type="i">
<li>init()</li>
<li>run_simulation_calculations()</li>
<li>get_results()</li>
</ol>
</li>
</ol>
</li>
<li>Additional Notes</li>
</ol>
<h1><a class="anchor" id="autotoc_md5"></a>
Module Overview</h1>
<p>The main module brings together all the components and environment data to simulate our solar-powered vehicles. Another primary objective of this module is to expose an interface for clients to extract data from Simulation instances.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Classes</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
Simulation</h2>
<p>The Simulation class is the core of Simulation. This class instantiates the car components and acquires environment data.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
init()</h3>
<p>Do not directly instantiate a Simulation object. Use the SimulationBuilder class instead. See <a href="../utils/module-info#SimulationBuilder">SimulationBuilder</a> for details and configuration of a Simulation instance.</p>
<h3><a class="anchor" id="autotoc_md9"></a>
run_model()</h3>
<p>Simulate the car for the entire duration of the race given a <code>speed</code> input. This function is mostly a wrapper around <code>Model.run_simulation_calculations</code>, which performs the actual calculations, that handles the considerable input and output processing that is required. It accepts the following parameters:</p><ul>
<li><code>speed</code> of type <code>NumPy.ndarray</code>: array of driving speeds in km/h that is the primary dependent variable to Simulation. Must be of length equal to <code>get_driving_time_divisions()</code>.</li>
<li><code>plot_results=False</code> of type <code>bool</code>: flag that controls whether results will be plotted.</li>
<li><code>verbose=False</code> of type <code>bool</code>: flag that controls whether verbose plotting and printing is used.</li>
<li><code>route_visualization=False</code> of type <code>bool</code>: flag that controls whether the route should be plotted.</li>
<li><code>plot_portion=(0.0, 1.0)</code> of type <code>tuple[float, float]</code>: Define the portion of the simulation that should be plotted through beginning and end percentages. Does nothing if <code>plot_results=False</code>.</li>
<li><code>is_optimizer=False</code> of type <code>bool</code>: flag that is used by optimizers to reduce verbosity. Returns either the <code>tine_taken</code>, <code>distance_travelled</code>, both, or nothing depending on the <code>SimulationReturnType</code> configured.</li>
</ul>
<h3><a class="anchor" id="autotoc_md10"></a>
get_results()</h3>
<p>Use this method to extract simulation data.</p>
<p>It accepts the following parameters:</p><ul>
<li><code>values</code> of type <code>NumPy.ndarray | list | tuple | set | str</code>: either a single string, or an iterable of keys (strings) defining which values to be extracted. See additional notes for valid keys. Also accepts <code>"default"</code> to return the values that were previously contained within the now-deprecated <code>SimulationResults</code> object. It returns the following values:</li>
<li><code>results</code> of type <code>list | NumPy.ndarray | float</code>: either a single array or value, if a single key was provided in <code>values</code>, or a list of values corresponding to the provided keys in <code>values</code>, in the order that they were provided.</li>
</ul>
<p>Example: <code>get_results(["solar_irradiances", "delta_energy"])</code> will return a <code>list</code> with length <code>2</code> where the first element is value corresponding to <code>solar_irradiances</code>, and the second element is the value corresponding to <code>delta_energy</code>.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
was_successful()</h3>
<p>Return whether the simulation was physically consistent. Currently, the metric that is verified is whether state of charge did not fall below <code>0%</code>, indicating that the speed input is physically achievable.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
get_distance_before_exhaustion()</h3>
<p>Return the distance travelled in km before state of charge falls below <code>0%</code>. Can be chained with <code>was_successful()</code> to verify whether this happens, as this method is not well-defined if this does not occur.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
get_driving_time_divisions()</h3>
<p>Returns the number of time divisions (length of a time division is based on granularity) that the car is permitted to be driving. Dependent on granularity and rules in competition configuration files.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md15"></a>
Model</h2>
<p>The Model class executes the simulation calculations and stores the result. This class should be considered to be a mutable container owned by a Simulation instance, and not accessed directly nor instantiated otherwise. </p>
<h3><a class="anchor" id="autotoc_md16"></a>
init()</h3>
<p>Do not instantiate a Model. </p>
<h3><a class="anchor" id="autotoc_md17"></a>
run_simulation_calculations()</h3>
<p>Perform all simulation calculations in order to fully simulate the car for the entire simulation duration. </p>
<h3><a class="anchor" id="autotoc_md18"></a>
get_results()</h3>
<p>Do not call <code>get_results</code> on a Model, instead call it on the Simulation instance which owns it.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Additional Notes</h1>
<p>When reading "Array of `x`", interpret as shorthand for "array containing the value of `x` at every tick/moment simulated".</p>
<p><b>Valid Keys:</b></p><ol type="1">
<li><code>speed_kmh</code>: Array of the car's speed in km/h.</li>
<li><code>distances</code>: Array of the car's distance travelled in km.</li>
<li><code>state_of_charge</code>: Array of the battery's state of charge as a decimal (between 0 and 1).</li>
<li><code>delta_energy</code>: Array of delta energy processed by the battery in Joules.</li>
<li><code>solar_irradiances</code>: Array of solar irradiances experienced by the solar arrays in W/m^2.</li>
<li><code>wind_speeds</code>: Array of wind speeds experienced by the car in the direction opposite to the bearing of the vehicle in m/s.</li>
<li><code>gis_route_elevations_at_each_tick</code>: Array of elevations of the car in m.</li>
<li><code>cloud_covers</code>: Array of cloud cover as a percentage (as a decimal).</li>
<li><code>distance</code>: Array of distances travelled between each tick in meters.</li>
<li><code>route_length</code>: Length of the route that will be simulated in km.</li>
<li><code>time_taken</code>: Time taken to reach the finish line (or simulation duration, if the finish line was not reached) in seconds.</li>
<li><code>tick_array</code>: Array of tick indices.</li>
<li><code>timestamps</code>: Array of timestamps in UNIX time.</li>
<li><code>time_zones</code>: Array of time zones experienced by the car as integers corresponding to the difference in hours from UTC.</li>
<li><code>cumulative_distances</code>: Array of cumulative distance in meters, effectively the distance travelled at the current point.</li>
<li><code>closest_gis_indices</code>: Array of indices corresponding to the GIS coordinate that the car is at.</li>
<li><code>closest_weather_indices</code>: Array of indices corresponding to the weather forecast that the car is at.</li>
<li><code>path_distances</code>: Array of distances between path coordinates.</li>
<li><code>max_route_distance</code>: Length of the route that will be simulated in meters.</li>
<li><code>gis_vehicle_bearings</code>: Array of the azimuth angle of the vehicle at every location.</li>
<li><code>gradients</code>: Array of road gradient as an angle in degrees of the vehicle at every location.</li>
<li><code>absolute_wind_speeds</code>: Array of wind speeds in m/s experienced by the car.</li>
<li><code>wind_directions</code>: Array of wind directions in degrees (meteorological standard).</li>
<li><code>lvs_consumed_energy</code>: Array of consumed energy by our low-voltage systems in Joules.</li>
<li><code>motor_consumed_energy</code>: Array of energy consumed by our motor in Joules.</li>
<li><code>array_produced_energy</code>: Array of energy produced by our solar arrays in Joules.</li>
<li><code>regen_produced_energy</code>: Array produced by our regenerative braking in Joules.</li>
<li><code>not_charge</code>: Boolean array indicating when we are not able to charge.</li>
<li><code>consumed_energy</code>: Array of total energy consumption in Joules.</li>
<li><code>produced_energy</code>: Array of total produced energy in Joules.</li>
<li><code>time_in_motion</code>: Time the car spent in motion in seconds.</li>
<li><code>final_soc</code>: The final state of charge at the end of simulation, or when the car reaches the finish line, as a decimal percentage.</li>
<li><code>distance_travelled</code>: Distance travelled by the car during the course of simulation in km.</li>
<li><code>map_data_indices</code>: Array of indices corresponding to a map coordinate.</li>
<li><code>path_coordinates</code>: Array of coordinates (latitude, longitude) of the car at every point, formatted as a two-dimensional NumPy array.</li>
<li><code>raw_soc</code>: Array of the car's state of charge before clipped to be a valid percentage. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
